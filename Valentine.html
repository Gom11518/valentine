<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Valentine Lock Screen</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap');

    body {
      margin: 0;
      overflow: hidden;
      background-color: #050205;
      font-family: 'Sarabun', sans-serif;
      user-select: none;
    }
    
    /* Canvas พื้นหลัง (หัวใจ 3D) - Z-index 1 */
    canvas {
      display: block;
      position: absolute;
      top: 0;
      left: 0;
      z-index: 1; 
    }

    /* --- ส่วนข้อความลอย (ใหม่) - Z-index 5 --- */
    #floatingTextContainer {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none; /* ไม่ขวางการกด */
        z-index: 5; /* อยู่หน้า canvas แต่อยู่หลัง lock screen */
        overflow: hidden;
    }

    .floating-text {
        position: absolute;
        color: rgba(255, 255, 255, 0.8); /* สีขาว โปร่งแสงนิดๆ */
        font-size: 0.85rem; /* ตัวเล็กๆ */
        font-weight: 300;
        white-space: nowrap;
        opacity: 0;
        text-shadow: 0 0 5px rgba(255, 105, 180, 0.5);
        /* อนิเมชั่นลอยและจาง */
        animation: floatMoveFade linear forwards;
    }

    @keyframes floatMoveFade {
        0% {
            opacity: 0;
            transform: translate(var(--startX), var(--startY)) scale(0.8);
        }
        20% {
            opacity: 1; /* ค่อยๆ ชัดขึ้น */
        }
        80% {
            opacity: 1; /* ค้างไว้สักพัก */
        }
        100% {
            opacity: 0; /* ค่อยๆ จางหาย */
            transform: translate(var(--endX), var(--endY)) scale(1);
        }
    }


    /* --- ส่วนหน้าจอ Lock Screen - Z-index 100 --- */
    #lockScreen {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 100;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(3px);
      transition: opacity 0.5s ease, visibility 0.5s;
    }

    .hint-text {
      font-size: 24px;
      color: #ffccff;
      margin-bottom: 25px;
      text-shadow: 0 0 10px rgba(255, 105, 180, 0.8);
      font-weight: bold;
      letter-spacing: 1px;
    }

    .pin-display { display: flex; gap: 15px; margin-bottom: 30px; }
    .pin-dot { width: 15px; height: 15px; border-radius: 50%; background: rgba(255, 255, 255, 0.3); border: 2px solid white; transition: all 0.2s; }
    .pin-dot.filled { background: white; box-shadow: 0 0 10px white; }

    .keypad { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }
    .key { width: 70px; height: 70px; border-radius: 15px; background: rgba(60, 60, 80, 0.8); color: white; font-size: 28px; font-weight: bold; display: flex; align-items: center; justify-content: center; cursor: pointer; border: 1px solid rgba(255, 255, 255, 0.2); box-shadow: 0 4px 15px rgba(0,0,0,0.3); transition: transform 0.1s, background 0.2s; }
    .key:active { transform: scale(0.95); background: rgba(255, 255, 255, 0.2); }
    .key.clear { background: #e74c3c; }
    .key.enter { background: #2ecc71; }

    @keyframes shake { 0% { transform: translateX(0); } 25% { transform: translateX(-10px); } 50% { transform: translateX(10px); } 75% { transform: translateX(-10px); } 100% { transform: translateX(0); } }
    .shake { animation: shake 0.3s ease-in-out; }


    /* --- ส่วนปุ่มกด (แก้ไขใหม่: เล็กลงเยอะๆ) - Z-index 50 --- */
    #secretContainer {
      position: absolute;
      bottom: 80px; 
      left: 0;
      width: 100%;
      display: flex;
      justify-content: center;
      z-index: 50;
      opacity: 0;
      pointer-events: none;
      transition: opacity 1s ease;
    }
    
    #secretContainer.show { pointer-events: auto; }

    /* สไตล์ปุ่มกดแบบใหม่ (เล็กมาก) */
    #enterBtn {
      /* ลด padding และ font-size ลงเยอะๆ */
      padding: 8px 25px;
      font-size: 0.9rem; 
      
      font-family: 'Sarabun', sans-serif;
      font-weight: bold;
      color: white;
      background: rgba(255, 105, 180, 0.6); /* โปร่งแสงขึ้นอีกนิด */
      border: 1.5px solid rgba(255, 255, 255, 0.4);
      border-radius: 30px; /* ปรับความมนให้เข้ากับขนาด */
      cursor: pointer;
      backdrop-filter: blur(5px);
      box-shadow: 0 2px 10px rgba(255, 105, 180, 0.3);
      transition: all 0.3s ease;
      white-space: nowrap;
      outline: none;
    }

    #enterBtn:hover {
      background: rgba(255, 105, 180, 0.9);
      transform: scale(1.05);
      box-shadow: 0 4px 15px rgba(255, 105, 180, 0.5), 0 0 5px #fff;
    }
    #enterBtn:active {
      transform: scale(0.95);
    }

  </style>
</head>
<body>

  <canvas id="heart"></canvas>
  
  <div id="floatingTextContainer"></div>

  <div id="lockScreen">
    <div class="hint-text">คำใบ้ : เวลารัก</div>
    <div class="pin-display" id="pinDisplay"><div class="pin-dot"></div><div class="pin-dot"></div><div class="pin-dot"></div><div class="pin-dot"></div></div>
    <div class="keypad">
      <div class="key" onclick="press(1)">1</div><div class="key" onclick="press(2)">2</div><div class="key" onclick="press(3)">3</div>
      <div class="key" onclick="press(4)">4</div><div class="key" onclick="press(5)">5</div><div class="key" onclick="press(6)">6</div>
      <div class="key" onclick="press(7)">7</div><div class="key" onclick="press(8)">8</div><div class="key" onclick="press(9)">9</div>
      <div class="key clear" onclick="clearPin()">✕</div><div class="key" onclick="press(0)">0</div><div class="key enter" onclick="checkPin()">✓</div>
    </div>
  </div>

  <div id="secretContainer">
      <button id="enterBtn" onclick="window.location.href='Valentine.html'">กดตรงนี้ค้าบบบ</button>
  </div>

<script>
  // --- ส่วน Logic ของ Lock Screen ---
  let currentPin = "";
  const correctPin = "2255"; // รหัสผ่าน

  function press(num) {
    if (currentPin.length < 4) {
      currentPin += num;
      updateDisplay();
    }
  }

  function clearPin() {
    currentPin = "";
    updateDisplay();
  }

  function updateDisplay() {
    const dots = document.querySelectorAll('.pin-dot');
    dots.forEach((dot, index) => {
      if (index < currentPin.length) dot.classList.add('filled');
      else dot.classList.remove('filled');
    });
  }

  function checkPin() {
    if (currentPin === correctPin) {
      const lockScreen = document.getElementById('lockScreen');
      lockScreen.style.opacity = '0';
      lockScreen.style.visibility = 'hidden';
      
      const secretContainer = document.getElementById('secretContainer');
      secretContainer.style.opacity = '1';
      secretContainer.classList.add('show');

    } else {
      const pinDisplay = document.getElementById('pinDisplay');
      pinDisplay.classList.add('shake');
      setTimeout(() => {
        pinDisplay.classList.remove('shake');
        currentPin = "";
        updateDisplay();
      }, 300);
    }
  }

  // --- ส่วนสร้างข้อความลอย (ใหม่) ---
  const textContainer = document.getElementById('floatingTextContainer');

  function spawnFloatingText() {
      const textEl = document.createElement('div');
      textEl.className = 'floating-text';
      textEl.innerText = 'รักตองนะจุ๊บๆ';

      // สุ่มตำแหน่งเริ่มและจบ (ให้อยู่ภายในจอ)
      const startX = Math.random() * window.innerWidth + 'px';
      const startY = Math.random() * window.innerHeight + 'px';
      // ขยับไปตำแหน่งใหม่แบบสุ่ม (ไม่ไกลมากเพื่อให้ดูช้าๆ)
      const endX = (Math.random() * window.innerWidth) + 'px';
      const endY = (Math.random() * window.innerHeight) + 'px';

      // ส่งค่าตัวแปรไปให้ CSS
      textEl.style.setProperty('--startX', startX);
      textEl.style.setProperty('--startY', startY);
      textEl.style.setProperty('--endX', endX);
      textEl.style.setProperty('--endY', endY);

      // สุ่มระยะเวลาลอย (ระหว่าง 15 ถึง 25 วินาที) -> ช้าๆ
      const duration = 15 + Math.random() * 10 + 's';
      textEl.style.animationDuration = duration;

      textContainer.appendChild(textEl);

      // ลบ element ทิ้งเมื่ออนิเมชั่นจบ เพื่อไม่ให้หนักเครื่อง
      setTimeout(() => {
          textEl.remove();
      }, parseFloat(duration) * 1000);
  }

  // สร้างข้อความใหม่ทุกๆ 0.8 วินาที (เยอะๆ)
  setInterval(spawnFloatingText, 800);


  // --- ส่วน Animation 3D พื้นหลัง ---
  const canvas = document.getElementById('heart');
  const ctx = canvas.getContext('2d');
  let width, height;
  const particles = [];
  const stars = [];
  const FOCAL_LENGTH = 400;
  const Z_OFFSET = 200;

  function resize() {
    width = canvas.width = window.innerWidth;
    height = canvas.height = window.innerHeight;
  }
  window.addEventListener('resize', resize);
  resize();

  function heartFunction(t, shrinkRatio = 11) {
    let x = 16 * Math.pow(Math.sin(t), 3);
    let y = -(13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t));
    x *= shrinkRatio; y *= shrinkRatio;
    return {x, y};
  }

  class Star {
    constructor() { this.reset(); }
    reset() {
      this.x = Math.random() * width * 1.5; 
      this.y = Math.random() * -height; 
      this.speed = Math.random() * 2 + 1; 
      this.len = Math.random() * 80 + 50;
      this.opacity = Math.random();
    }
    draw() {
      ctx.beginPath();
      const gradient = ctx.createLinearGradient(this.x, this.y, this.x + this.len, this.y - this.len);
      gradient.addColorStop(0, "rgba(255, 255, 255, " + this.opacity + ")");
      gradient.addColorStop(1, "rgba(255, 255, 255, 0)");
      ctx.strokeStyle = gradient;
      ctx.lineWidth = 1.5;
      ctx.moveTo(this.x, this.y);
      ctx.lineTo(this.x + this.len, this.y - this.len);
      ctx.stroke();
    }
    update() {
      this.x -= this.speed; this.y += this.speed;
      if (this.y > height + 100 || this.x < -100) this.reset();
      this.draw();
    }
  }

  class Particle {
    constructor(x, y, z, size, color) {
      this.baseX = x; this.baseY = y; this.baseZ = z;
      this.x = x; this.y = y; this.baseSize = size; this.size = size; this.color = color;
    }
    draw() {
      if (this.size < 0.1) return;
      ctx.fillStyle = this.color;
      ctx.beginPath();
      ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
      ctx.fill();
    }
    update(time) {
      const beat = 1 + Math.sin(time * 3) * 0.05; 
      let cx = this.baseX * beat;
      let cy = this.baseY * beat;
      let cz = this.baseZ * beat;

      const angle = time * 0.8; 
      let rotX = cx * Math.cos(angle) - cz * Math.sin(angle);
      let rotZ = cx * Math.sin(angle) + cz * Math.cos(angle);
      let rotY = cy;

      const scale = FOCAL_LENGTH / (FOCAL_LENGTH + rotZ + Z_OFFSET);
      this.x = width / 2 + rotX * scale;
      this.y = height / 2 + rotY * scale;
      this.size = this.baseSize * scale;
      this.draw();
    }
  }

  function init() {
    const randomZ = () => (Math.random() - 0.5) * 30;
    // แก้ไข: เพิ่มความละเอียดของขอบหัวใจ (ลด step ลง)
    for (let i = 0; i < Math.PI * 2; i += 0.005) {
      const pos = heartFunction(i, 15);
      particles.push(new Particle(pos.x, pos.y, randomZ() * 0.5, 1.5, '#ea80b0'));
    }
    // แก้ไข: เพิ่มจำนวนจุดเนื้อใน (จาก 1500 เป็น 3000)
    for (let i = 0; i < 3000; i++) {
        const t = Math.random() * Math.PI * 2;
        const pos = heartFunction(t, 15);
        const len = Math.sqrt(Math.random()) * 0.95; 
        const x = pos.x * len;
        const y = pos.y * len;
        particles.push(new Particle(x, y, randomZ(), Math.random() * 1.5, '#ea80b0'));
    }
    // แก้ไข: เพิ่มจำนวนจุดฟุ้งรอบนอก (จาก 1000 เป็น 2000)
    for (let i = 0; i < 2000; i++) {
        const t = Math.random() * Math.PI * 2;
        const pos = heartFunction(t, 15);
        const x = pos.x + (Math.random() - 0.5) * 10;
        const y = pos.y + (Math.random() - 0.5) * 10;
        particles.push(new Particle(x, y, randomZ() * 1.5, Math.random() * 1, '#ff99cc'));
    }
    
    // แก้ไข: เพิ่มจำนวนดาวตกเพื่อให้เห็นทั่วจอรวมถึงฝั่งขวา (จาก 15 เป็น 60)
    for(let i = 0; i < 60; i++) { stars.push(new Star()); }
  }

  let time = 0;
  function animate() {
    ctx.fillStyle = 'rgba(5, 2, 5, 0.2)'; 
    ctx.fillRect(0, 0, width, height);
    time += 0.015;
    stars.forEach(s => s.update());
    particles.sort((a, b) => b.baseZ - a.baseZ);
    particles.forEach(p => p.update(time));
    requestAnimationFrame(animate);
  }

  init();
  animate();
</script>

</body>
</html>
